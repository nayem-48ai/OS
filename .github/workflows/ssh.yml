name: Terminus SSH Final
on: 
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  ssh-access:
    runs-on: ubuntu-latest
    steps:
      - name: Setup
        run: |
          # ইউজার তৈরি
          sudo useradd -m -s /bin/bash tnayem48
          echo "tnayem48:tnayem48" | sudo chpasswd
          sudo usermod -aG sudo tnayem48
          sudo service ssh start
          
          # Localtunnel (lt) ইন্সটল
          sudo npm install -g localtunnel
          
          echo "Starting Tunnel..."
          # টানেল চালু এবং হোস্ট ডিটেইলস দেখানো
          lt --port 22 --host https://localtunnel.me > tunnel.txt 2>&1 &
          
          sleep 10
          
          echo "=========================================="
          echo "   COPY THESE TO TERMINUS APP   "
          echo "=========================================="
          # লগের ভেতর থেকে url বের করা
          grep -o 'https://.*' tunnel.txt | sed 's/https:\/\///' > host.txt
          echo "Host: $(cat host.txt)"
          echo "Port: 22"
          echo "Username: tnayem48"
          echo "Password: tnayem48"
          echo "=========================================="
          
          # সেশন সচল রাখা
          sleep 21600
